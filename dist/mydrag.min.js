!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";!function(t,i){var e=function(t,i){return new e.fn.init(t,i)};e.config={adsorb:!0,rate:5,initX:0,initY:0,gap:10},e.events={TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",RESIZE:"resize"},e.fn=e.prototype={constructor:e,init:function(t,i){this.elem=document.querySelector(t),this.rect=null,this.config=this.mergeConfig(i),this.winW=this.getWin().width,this.winH=this.getWin().height,this.initX=0,this.initY=0,this.oldX=0,this.oldY=0,this.newX=0,this.newY=0,this.x=0,this.y=0,this.limit={l:0,r:0,t:0,b:0},this.gap=this.config.gap,this.areaId=0,this.isTouching=!1,this.initData(),this.addListening()},initData:function(){this.rect=this.elem.getBoundingClientRect(),this.limit.l=this.gap,this.limit.r=this.winW-this.rect.width-this.gap,this.limit.t=this.gap,this.limit.b=this.winH-this.rect.height-this.gap;var t=this.config.initX,i=this.config.initY;(t<this.gap||t>this.limit.r)&&(t=e.config.initX+this.gap),(i<this.gap||i>this.limit.b)&&(i=e.config.initY+this.gap),this.initX=this.oldX=this.newX=t,this.initY=this.oldY=this.newY=i,this.setPos(t,i)},addListening:function(){var i=this.detectPassive();this.elem.addEventListener("touchstart",this),this.elem.addEventListener("touchmove",this,i),this.elem.addEventListener("touchend",this),t.addEventListener("resize",this)},removeListener:function(){this.elem.removeEventListener("touchstart",this.touchStart),this.elem.removeEventListener("touchmove",this.touchMove),this.elem.removeEventListener("touchend",this.touchEnd),t.removeEventListener("resize",this.resize)},handleEvent:function(t){return function(i,e){switch(i){case e.TOUCH_START:this.touchStart(t);break;case e.TOUCH_MOVE:this.touchMove(t);break;case e.TOUCH_END:this.touchEnd(t);break;case e.RESIZE:this.resize()}}.bind(this)(t.type,e.events)},touchStart:function(t){t.cancelable&&t.preventDefault();var i=t.touches&&t.touches[0]||t;this.isTouching=!0,this.newX&&(this.initX=this.newX),this.newY&&(this.initY=this.newY),this.oldX=i.clientX,this.oldY=i.clientY},touchMove:function(t){if(this.isTouching){t.cancelable&&t.preventDefault();var i=t.touches&&t.touches[0]||t,e=i.clientX-this.oldX,s=i.clientY-this.oldY;this.x=this.initX+e,this.y=this.initY+s,this.setPos(this.x,this.y),this.newX=this.x,this.newY=this.y,this.detectEdge(),this.detectArea()}},touchEnd:function(){if(this.isTouching&&(this.isTouching=!1,this.removeListener(),this.config.adsorb)){var t=this.limit.l,i=this.limit.r,e=this.areaId,s=this.config.rate,h=0===e?t:1===e?i:this.x,n=function(){if(!this.isTouching){var t=this.easeout(this.x,h,s);void 0!==t?(this.x=t,this.newX=t,this.setPos(this.x,this.y),requestAnimationFrame(n)):this.newX=h}}.bind(this);n()}},resize:function(){this.winW=this.getWin().width,this.winH=this.getWin().height,this.initData()},detectArea:function(){var t=this.winW/2,i=this.x+this.rect.width/2;this.areaId=i<t?0:1},detectEdge:function(){var t=!1,i=this.x,e=i+this.rect.width,s=this.y,h=s+this.rect.height;i<=this.gap&&(t=!0,this.x=this.limit.l),e>=this.winW-this.gap&&(t=!0,this.x=this.limit.r),s<=this.gap&&(t=!0,this.y=this.limit.t),h>=this.winH-this.gap&&(t=!0,this.y=this.limit.b),t&&this.setPos(this.x,this.y)},setPos:function(t,i){var e=[Math.round(1e3*t)/1e3+"px",Math.round(1e3*i)/1e3+"px",0].join(",");this.elem.style.transform="translate3d("+e+")"},easeout:function(t,i,e){if(t!==i){var s=t||0,h=i||0;return s+=(h-s)/(e||5),Math.abs(h-s)<1?h:s}},detectPassive:function(){var i=!1;try{var e=Object.defineProperty({},"passive",{get:function(){return i=!0,!0}});t.addEventListener("test",null,e),t.removeEventListener("test",null)}catch(t){}return!!i&&{passive:!1}},mergeConfig:function(t){var i={},s=e.config;for(var h in s)t&&void 0!==t[h]?i[h]=t[h]:i[h]=s[h];return i},getWin:function(){var i=t.document.documentElement;return{width:i.clientWidth,height:i.clientHeight}}},e.fn.init.prototype=e.fn,t.Mydrag=e}(window)}));
